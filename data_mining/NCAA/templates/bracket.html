{% extends 'base.html' %}

{% block script %}
	<script type="text/javascript">
		{% if selectedTeams %}
			$(document).ready(function() {
				var selectedTeams = [{% for team in selectedTeams %}
										"{{team}}"
									{% ifnotequal forloop.counter selectedTeams|length %},{% endifnotequal %}{% endfor %}];
				var numGames = parseInt($('#number_of_games')[0].options[$('#number_of_games')[0].options.selectedIndex].text);

				for (var i=0; i<numGames; i++) {
					var currentList = $('.teamList')[i];
					for (var j=0; j<currentList.length; j++) {
						if (currentList.options[j].text == selectedTeams[i]) {
							currentList.options[j].selected = true;
							break;
						}
					}
				}
			});
		{% endif %}
		
		$(document).ready(function(){
			$('#number_of_games').change(function() {
				var numGames = parseInt($(this)[0].options[$(this)[0].options.selectedIndex].text);
				
				for (var i=1; i<=numGames; i++) {
					$('#team'+i.toString()).show();
				}
				
				for (var i=numGames+1; i<=32; i++) {
					$('#team'+i.toString()).hide();
				}
			});
		});
	</script>
{% endblock %}

{% block body %}
	<form action="/NCAA/simulate/" method="post" id="simulateForm">
	{% csrf_token %}
	<input type="submit" name="submit" id="simulateButton" value="Simulate!"/>
	<input type="submit" name="test" value="Test!"/>
	<select name="classifier">
		<option value="cluster"
				{% ifequal classifier "cluster" %}
					selected="true"
				{% endifequal %}>Cluster (simple)</option>
		<option value="cluster_normalize"
				{% ifequal classifier "cluster_normalize" %}
					selected="true"
				{% endifequal %}>Cluster (normalize)</option>
		<option value="decision_tree"
				{% ifequal classifier "decision_tree" %}
					selected="true"
				{% endifequal %}>Decision tree (bad)</option>
		<option value="naive_bayes"
				{% ifequal classifier "naive_bayes" %}
					selected="true"
				{% endifequal %}>Naive Bayes (simple)</option>
		<option value="naive_bayes_ranking"
				{% ifequal classifier "naive_bayes_ranking" %}
					selected="true"
				{% endifequal %}>Naive Bayes (ranking)</option>
	</select>
	<select id="number_of_games" name="number_of_games">
		<option value="2"
				{% ifequal numGames 2 %}
					selected="true"
				{% endifequal %}>2</option>
		<option value="4"
				{% ifequal numGames 4 %}
					selected="true"
				{% endifequal %}>4</option>
		<option value="8"
				{% ifequal numGames 8 %}
					selected="true"
				{% endifequal %}>8</option>
		<option value="16"
				{% ifequal numGames 16 %}
					selected="true"
				{% endifequal %}>16</option>
		<option value="32"
				{% ifequal numGames 32 %}
					selected="true"
				{% endifequal %}>32</option>
	</select>
	<table class="bracketList">
		<tr>
			<td>
			<table class="bracket">
				{% for i in numGames_list %}
				<tr id="team{{i}}"
					{% if i > numGames %}
						style="display: none;"
					{% endif %}>
					<td>
						<select class="teamList" name="team{{i}}">
							{% for team in teams %}
								<option value="{{team.year}} {{team.teamname}}">
									{{team.year}} {{team.teamname}}
								</option>
							{% endfor %}
						</select>
					</td>
				</tr>
				{% endfor %}
			</table>
			</td>
			{% for round in games %}
				<td>
					<table class="bracket">
						{% ifequal round|length 1 %}
							<tr><td class="winner">{{ round.0 }}</td></tr>
						{% else %}
							{% for game in round %}
								<tr><td>{{ game }}</td></tr>
							{% endfor %}
						{% endifequal %}
					</table>
				</td>
			{% endfor %}
		</tr>
	</table>

{% endblock %}